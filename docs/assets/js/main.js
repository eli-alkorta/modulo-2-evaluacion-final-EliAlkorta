"use strict";const inputSearchSeries=document.querySelector("#series-name"),searchButton=document.querySelector(".search-button"),listOfFavs=document.querySelector(".favourites-list"),consultedSeries=document.querySelector(".consulted-list"),deleteAll=document.querySelector(".deleteAllButton");let series=[],favSeries=readLocalStorage(),favsIdList=[],inputElem=null;const urlBase="http://api.tvmaze.com/search/shows?q=";let defaultImage="https://via.placeholder.com/210x295",favId=null;function getSeries(){inputElem=inputSearchSeries.value,fetch(`${urlBase}${inputElem}`).then(e=>e.json()).then(e=>{series=e,paintResult(series),paintFavs(favSeries)})}function paintResult(e){consultedSeries.innerHTML="";for(let t of e)null===t.show.image?consultedSeries.innerHTML+=`<li class="list-item1" id=${t.show.id}><p class="main-title1">${t.show.name}</p><img src=${defaultImage}></li>`:consultedSeries.innerHTML+=`<li class="list-item1" id=${t.show.id}><p class="main-title1">${t.show.name}</p><img src=${t.show.image.medium}></li>`;addListeners(series)}function addListeners(){const e=document.querySelectorAll(".list-item1");for(let t of e)t.addEventListener("click",addToFavouriteHandler)}function addToFavouriteHandler(){addToFavourite(event),getObjectById(favId)}function addToFavourite(e){e.currentTarget.classList.add("red");let t=parseInt(e.currentTarget.id);-1===favsIdList.indexOf(t)?(favsIdList.push(t),getObjectById(t)):favsIdList.splice(t,1)}function getObjectById(e){for(let t of series)if(t.show.id===e){let e=t;favSeries.push(e),setLocalStorage(favSeries),paintFavs(favSeries)}}function setLocalStorage(e){localStorage.setItem("favSeries",JSON.stringify(e))}function readLocalStorage(){let e=JSON.parse(localStorage.getItem("favSeries"));return null!==e?e:[]}function paintFavs(e){listOfFavs.innerHTML="";for(let t of e)null===t.show.image?listOfFavs.innerHTML+=`<li class="list-item" id=${t.show.id}><div class="container"><img src=${defaultImage}><button type="button" class="erase-button">X</button><p class="main-title">${t.show.name}</p></div></li>`:listOfFavs.innerHTML+=`<li class="list-item" id=${t.show.id}><div class="container"><img src=${t.show.image.medium}><button type="button" class="erase-button">X</button><p class="main-title">${t.show.name}</p></div></li>`;""===listOfFavs.innerHTML?deleteAll.classList.add("hidden"):deleteAll.classList.remove("hidden"),eraseFavListeners(e)}function eraseFavListeners(){document.body.addEventListener("click",eraseFav)}function eraseFav(e){if(e.target.classList.contains("erase-button")){e.target.parentElement.parentElement.remove();let t=e.target.id;favSeries.splice(t,1),setLocalStorage(favSeries)}}function resetFavs(){favSeries=[],setLocalStorage(favSeries),paintFavs(favSeries)}function init(){paintFavs(favSeries)}window.addEventListener("load",init),searchButton.addEventListener("click",getSeries),deleteAll.addEventListener("click",resetFavs);